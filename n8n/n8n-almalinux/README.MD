# Guide: Automated n8n Installation on Ubuntu

This script provides a comprehensive, automated solution for installing n8n on a fresh Ubuntu server. It handles everything from dependency installation to final configuration, including setting up Docker, a PostgreSQL database, an Nginx reverse proxy, and a free SSL certificate from Let's Encrypt.

### Key Features

- **DNS Validation**: Automatically checks if your domain correctly points to the server's IP address before starting.
- **Previous Installation Cleanup**: Detects and offers to completely remove any previous n8n installations to prevent conflicts.
- **Automatic Dependency Management**: Installs and configures all necessary packages, including Nginx, Docker, and Docker Compose.
- **Automated Nginx Reverse Proxy**: Creates and enables the Nginx configuration to proxy traffic to the n8n application.
- **Automated SSL**: Uses `certbot` to install a Let's Encrypt SSL certificate for your domain and configures Nginx for HTTPS, including setting up auto-renewal.
- **Two Setup Modes**:
  - **Manual Mode**: You provide all your credentials.
  - **Automatic Mode**: The script generates secure credentials for you, perfect for a quick setup.
- **Health Checks**: Performs post-install checks to ensure the n8n container is running and can connect to the database.

### Prerequisites

- A server running **Ubuntu**.
- `sudo` or `root` access.
- A **domain name** (e.g., `n8n.yourcompany.com`) with its DNS 'A' record already pointed to your server's public IP address. The script will verify this.

---

## How to Use

### Step 1: Download the Script

Connect to your server via SSH and download the script using `wget`.

```bash
wget https://raw.githubusercontent.com/trangc0der/trangc0der-tools/main/n8n/n8n-ubuntu/n8n-ubuntu.sh
```

### Step 2: Make the Script Executable

Grant execute permissions to the downloaded file.

```bash
chmod +x n8n-ubuntu.sh
```

### Step 3: Run the Script

Execute the script with `sudo` to begin the installation.

```bash
sudo ./n8n-ubuntu.sh
```

### Step 4: Follow the On-Screen Prompts

The script is interactive and will guide you through the process:

1.  **Previous Installation Check**: If the script detects an existing n8n setup, it will ask if you want to clean it before proceeding.
2.  **Domain Name**: You will be prompted to enter your domain name. The script will then perform a DNS check. If it fails, you can choose to re-check, ignore the warning (if you are sure the DNS is correct but hasn't propagated yet), or cancel.
3.  **Installation Mode**: Choose between two modes:
    - **Manual Mode (1)**: You will be asked to enter an email for SSL registration, a username/password for n8n, and credentials for the PostgreSQL database.
    - **Automatic Mode (2)**: The script will automatically generate all necessary credentials based on your domain and server IP. It will display the generated credentials for you to save.

The script will then proceed with the full installation and configuration automatically.

### Post-Installation

Once the script is finished, you will see a summary of all your configuration details and credentials.

- **Access Your n8n Instance**: You can now access n8n by navigating to your domain in a web browser: `https://your-domain.com`.
- **Log In**: Use the n8n username and password that were either provided by you (Manual Mode) or generated by the script (Automatic Mode).

### Managing Your n8n Instance

The script provides helpful commands for managing your application at the end of the output.

- **Configuration Directory**: All n8n and PostgreSQL data and configuration files are located in `~/n8n_data`.
- **View n8n Logs**:
  ```bash
  docker logs n8n
  ```
- **View PostgreSQL Logs**:
  ```bash
  docker logs postgres
  ```
- **Restart n8n**:
  ```bash
  docker restart n8n
  ```
- **Stop/Start n8n**:
  ```bash
  docker stop n8n
  docker start n8n
  ```
- **Restart Both Services**: If you experience database connection issues, restart both containers.
  ```bash
  docker restart postgres n8n
  ```
